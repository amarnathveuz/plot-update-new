{% extends "super_admin/base.html" %}
{% load static %}
{% load notification %}
{% block content %}
<style>
    .form-control.mystyle {
        background-color: #dddddd26;


    }
</style>

<form action="" method="POST" enctype="multipart/form-data">
    {% csrf_token %}


    <div class="content">
        <div class="container-fluid px-0 customer-contact">


            <div class="row">
                <div class="col-12 px-0">
                    <div class="page-title-box d-sm-flex align-items-center justify-content-between">


                        <div class="page-title-left w-100">
                            <ol class="breadcrumb m-0">
                                <!-- <li class="breadcrumb-item"><a href="property_management">Property Management</a>
                                </li>
                                <li class="breadcrumb-item active"><a href="javascript: void(0);"></a></li> -->

                            </ol>
                            <div class="d-flex justify-content-between align-items-center">
                           
                                <div class="contact-pag d-flex align-items-center">
                                    <!-- <i class="fas fa-caret-left mr-1 pagintn text-muted"
                                                        aria-hidden="true"></i><span class="text-muted"> 1 0f
                                                        10</span><i class="fas fa-caret-right ml-1 pagintn text-muted"
                                                        aria-hidden="true"></i> -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-lg-12 px-0">
                    <div class="card noti-card" id="orderList">
                        <div class="card-body bb-0 pt-0 p-0">
                            <div>
                                <div class="payslip mb-5">
                                    <div class="row pay-main mb-2 px-0">
                                        <div class="customer-head mb-5 col-md-12">
                                            <div class="row">
                                                <div class="col-md-4">
                                                    <input type="hidden" name="id" value="{{data.id}}">
                                                    <h3 id="old_block_unit" class="leave-head">{{data.property_mapping_id.BlockNo}}
                                                        {{data.property_mapping_id.UnitNo}}</h3>

                                                    <div class="row" id="unit_block" style="display:none;">
                                                        <div class="col-md-4">
                                                            <h6>Unit No | Block No</h6>
                                                        </div>
                                                        <div class="col-md-4 d-flex align-items-center">
                                                            <div class="form-group  required_item w-100  mr-2">
                                                                <input style="outline: none;" type="text"
                                                                    id="basiInput2" name="UnitNo"
                                                                    value="{{data.UnitNo}}"
                                                                    class="input form-control mystyle">
                                                            </div>

                                                            <div class="form-group  required_item w-100">
                                                                <input name="BlockNo" id="basiInput3"
                                                                    value="{{data.BlockNo}}" type="text"
                                                                    class="input form-control mystyle">
                                                            </div>
                                                        </div>

                                                    </div>


                                                </div>

                                                <div class="col text-right" id="current_status_id">

                                                    {% if data.booking_status == 0 %}
                                                    <button style="background-color: #008000; " type="button"
                                                        class="btn btn-pri pay discard-payroll noti-tag">Available
                                                    </button>
                                                    {% elif data.booking_status == 1 %}
                                                    <button style="background-color: orange; " type="button"
                                                        class="btn btn-pri pay discard-payroll noti-tag">Price Quotation
                                                    </button>
                                                    {% elif data.booking_status == 2 %}
                                                    <button style="background-color: #e40000;" type="button"
                                                        class="btn btn-pri pay discard-payroll noti-tag">Sold
                                                    </button>
                                                    {% elif data.booking_status == 3 %}
                                                    <button style="background-color: gray;" type="button"
                                                        class="btn btn-pri pay discard-payroll noti-tag">Cancelled
                                                    </button>
                                                    {%endif%}


                                                    {% if data.booking_status == 0 %}
                                                    <button style="background-color: #008000; " type="button"
                                                        class="btn btn-pri pay discard-payroll noti-tag">متاح
                                                    </button>
                                                    {% elif data.booking_status == 1 %}
                                                    <button style="background-color: orange; " type="button"
                                                        class="btn btn-pri pay discard-payroll noti-tag">عرض سعر
                                                    </button>
                                                    {% elif data.booking_status == 2 %}
                                                    <button style="background-color: #e40000;" type="button"
                                                        class="btn btn-pri pay discard-payroll noti-tag">تم الربط
                                                    </button>
                                                    {% elif data.booking_status == 3 %}
                                                    <button style="background-color: gray;" type="button"
                                                        class="btn btn-pri pay discard-payroll noti-tag">ألغيت
                                                    </button>
                                                    {%endif%}

                                                </div>

                                            </div>
                                            <div class="row mt-4">
                                                <div class="col-md-4 cust-details p-0">

                                                    <div class="row" id="unit_no_id" style="display: none;">
                                                        <div class="col-md-3 br-right d-flex align-items-center">
                                                            <h6>Unit No</h6>
                                                        </div>
                                                        <div class="col-md-8 d-flex align-items-center">
                                                            <div class="form-group  required_item w-100">
                                                                <input type="number" id="basiInput2" disabled
                                                                    name="UnitNo" value="{{data.UnitNo}}"
                                                                    class="input mt-2 form-control mystyle">
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row" id="block_no_id" style="display: none;">
                                                        <div class="col-md-3 br-right d-flex align-items-center">
                                                            <h6>Block No</h6>
                                                        </div>
                                                        <div class="col-md-8 d-flex align-items-center">
                                                            <div class="form-group  required_item w-100">
                                                                <input name="BlockNo" id="basiInput3" disabled
                                                                    value="{{data.BlockNo}}" type="number"
                                                                    class="input mt-2 form-control mystyle">
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-md-3 br-right d-flex align-items-start">
                                                            <h6 class="my-0">Name</h6>
                                                        </div>
                                                        <div class="col-md-8 d-flex align-items-start">

                                                            <div class="form-group  required_item w-100">
                                                                <input type="text" id="basiInput1" disabled name="Name"
                                                                    value="{% if data.name == None %}{% else %}{{data.name}}{% endif %}"
                                                                    class="input form-control mystyle" placeholder="">
                                                            </div>

                                                        </div>

                                                    </div>

                                                    <div class="row">
                                                        <div class="col-md-3 br-right d-flex align-items-start">
                                                            <h6 class="my-0">Phone</h6>
                                                        </div>
                                                        <div class="col-md-8 d-flex align-items-start">
                                                            <div class="form-group  required_item w-100">
                                                                <input required type="text" autocomplete="off"
                                                                    onkeyup="startdigit(this)" maxlength="9"
                                                                    minlength="9" id="basiInput31" disabled
                                                                    name="Phoneno"
                                                                    value="{%if data.phone == None %}{% else %}{{data.phone}}{% endif %}"
                                                                    class="input form-control mystyle" placeholder="">
                                                                    <div style="color: red; display:none ;" id="new_id"></div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-md-3 br-right d-flex align-items-start">
                                                            <h6 class="my-0">Land Area </h6>
                                                        </div>
                                                        <div class="col-md-8">
                                                            <div class="form-group  required_item w-100">
                                                                <input name="LandArea" value="{{data.property_mapping_id.LandArea}}"
                                                                    id="basiInput5" disabled type="text"
                                                                    class="input form-control mystyle">
                                                            </div>
                                                        </div>
                                                    </div>


                                                </div>

                                                <div class="col-md-4 cust-details p-0">

                                                    <div class="row">
                                                        <div class="col-md-3 br-right d-flex align-items-start">
                                                            <h6 class="my-0">Customer Id</h6>
                                                        </div>
                                                        <div class="col-md-8 d-flex align-items-start">
                                                            <div class="form-group  required_item w-100">
                                                                    <input autocomplete="off" maxlength="10" minlength="10"
                                                                onkeyup="customer_length()" required
                                                               
                                                                name="customer_id" type="text" id="customer_id"
                                                                disabled
                                                                value="{%if data.booking_id == None %}{%else %}{{data.booking_id}}{% endif %}"
                                                                class="input form-control mystyle">
                                                            </div>
                                                        </div>

                                                    </div>

                                                    <div class="row">
                                                        <div class="col-md-3 br-right d-flex align-items-start">
                                                            <h6 class="my-0">Unit Area</h6>
                                                        </div>
                                                        <div class="col-md-8 d-flex align-items-start">
                                                            <div class="form-group  required_item w-100">
                                                                <input name="UnitArea" id="basiInput4" disabled
                                                                    value="{{data.property_mapping_id.UnitArea}}" type="text"
                                                                    class="input form-control mystyle">

                                                            </div>
                                                        </div>

                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-3 br-right d-flex align-items-start">
                                                            <h6 class="my-0">Unit Type </h6>
                                                        </div>
                                                        <div class="col-md-8">
                                                            <div class="form-group  required_item w-100">
                                                                <input name="UType" type="text" id="basiInput6" disabled
                                                                    value="{% if data.property_mapping_id.UType == None %}{% else %}{{data.property_mapping_id.UType}}{% endif %}"
                                                                    class="input form-control mystyle">
                                                            </div>
                                                        </div>
                                                    </div>

                                                </div>



                                                <div class="col-md-4 cust-details p-0">
                                                    
                                                    <div class="row">
                                                        <div class="col-md-3 br-right d-flex align-items-start">
                                                            <h6 class="my-0">Price</h6>
                                                        </div>

                                                      
                                                        <div class="col-md-4 d-flex align-items-start">
                                                            <div class="form-group  required_item w-100 mr-2"
                                                                style="min-width: 70%;">
                                                                
                                                                <input name="Price" style="display:none;"
                                                                onkeypress="return onlyNumberKey(event)"
                                                                id="basiInput7" 
                                                                value="{{data.Price|floatformat:"0"}}" type="text"
                                                                class="input form-control">
                                                                
                                                                <div style="color: red; display:none ;font-size: 9px;" id="decimal_no"></div>

                                                                <input  
                                                                onkeypress="return onlyNumberKey(event)"
                                                                id="price_id" disabled
                                                                value="{{data.Price|floatformat:"0"}}" type="text"
                                                                class="input form-control mystyle">
                                                                <!-- <input name="Price"
                                                                    onkeypress="return onlyNumberKey(event)"
                                                                    id="basiInput7" disabled
                                                                    value="{{data.Price|floatformat:"0"}}" type="text"
                                                                    class="input form-control mystyle"> -->
                                                            </div>

                                                            <div class="form-group  required_item w-100"  style="min-width: 50px;">
                                                                <input name="currency" id="basiInput9" disabled
                                                                    value="SAR" type="text"
                                                                    class="input form-control mystyle">
                                                            </div>
                                                        </div>
                                                       
                                                      
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-md-3 br-right d-flex align-items-start">
                                                            <h6 class="my-0">Bank </h6>
                                                        </div>
                                                        <div class="col-md-9 d-flex align-items-start">
                                                            <style>
                                                                .select_box_bank{
                                                                    background-color:#dddddd26!important;
                                                                }
                                                                .select_box_bank1{
                                                                    background-color: #ffffff!important;
                                                                }
                                                            </style>
                                                            <div class="form-group  required_item w-100 bankselect ">

                                                                
                                                                <select class="select2 mystyle select_box_bank" name="Bank"
                                                                    id="basiInput8" disabled>

                                                                    {% if data.Bank == '' %}
                                                                    <option value="select bank">Select Bank</option>

                                                                    {% else %}
                                                                    <option value="{{data.Bank}}">{{data.bank}}</option>

                                                                    {% endif %}
                                                                    {% for i in bank_details %}
                                                                    {% if i.bank_name == data.Bank %}
                                                                    {% else %}
                                                                    <option value="{{i.bank_name}}">{{i.bank_name}}
                                                                    </option>
                                                                    {% endif %}

                                                                    {% endfor %}
                                                                </select>
                                                                <!-- <input name="Bank" id="basiInput8" disabled value="{{data.Bank}}" type="text" class="input mt-2 form-control mystyle">     -->
                                                            </div>
                                                        </div>

                                                    </div>


                                                    <div id="status_show" class="row" style="display: none;">
                                                        <div class="col-md-3 br-right d-flex align-items-start">
                                                            <h6 class="my-0">Status </h6>
                                                        </div>
                                                        <div class="col-md-9 d-flex align-items-start" id="select_div">
                                                            <style>
                                                                .select_box_clr {
                                                                    background-color: #8c95a126 !important;
                                                                }

                                                                .select_box_clr1 {
                                                                    background-color: #ffffff !important;
                                                                }
                                                            </style>
                                                            <select id="select_box" disabled name="current_status"
                                                                class="floatLabel form-select mystyle select_box_clr"
                                                                aria-placeholder="Employee">

                                                                {% if data.current_status == "0" %}
                                                                <option value="0">Available</option>

                                                                {% elif data.current_status == "1" %}
                                                                <option value="1">Price Quotation</option>

                                                                {% elif data.current_status == "2" %}
                                                                <option value="2">Sold</option>
                                                                {% elif data.current_status == "3" %}
                                                                <option value="3">Cancelled</option>
                                                                {% endif %}

                                                                {% if data.current_status == "0" %}

                                                                {% else %}
                                                                <option value="0">Available</option>
                                                                {% endif %}

                                                                {% if data.current_status == "1" %}

                                                                {% else %}
                                                                <option value="1">Price Quotation</option>
                                                                {% endif %}
                                                                {% if data.current_status == "2" %}

                                                                {% else %}
                                                                <option value="2">Sold</option>
                                                                {% endif %}
                                                                {% if data.current_status == "3" %}

                                                                {% else %}
                                                                <option value="3">Cancelled</option>
                                                                {% endif %}

                                                            </select>
                                                        </div>

                                                    </div>



                                                    {% if user_type.is_superuser %}
                                                    <div class="row">

                                                        <div class="col-md-3 br-right d-flex align-items-start">
                                                            <h6 class="my-0">Attachments</h6>
                                                        </div>
                                                        <div class="col-md-9 d-flex align-items-start">



                                                            <div id="attachment_id12" class="row w-100"
                                                                style="display: block">
                                                                <script>
                                                                    function redirectIt(obj) {

                                                                        var goToLink = obj.getAttribute("href");
                                                                        window.location.href = goToLink;
                                                                    }
                                                                </script>
                                                                {% for i in multiple_image_data %}
                                                                <div class="files-wr1 w-100" data-count-files="1">
                                                                    <div class="one-file">
                                                                        <a class="file-item"><span
                                                                                class="file-name max-lines"
                                                                                style="width: 100%;">{{i.image_name}}</span>


                                                                            <span onclick="redirectIt(this)"
                                                                                href="delete_image_action?id={{i.id}}"
                                                                                class="btn " style="margin-left: 5px;
                                                                                width: 20px;
                                                                                height: 20px;
                                                                                border-radius: 3px;
                                                                                color: #fff;
                                                                                text-align: center;
                                                                                padding: 2px;
                                                                                font-size: 11px;
                                                                                transition: all 0.2s;
                                                                                background-color: #be0000;">

                                                                                <i class="fa fa-times"
                                                                                    aria-hidden="true"></i>
                                                                            </span>
                                                                        </a>
                                                                        </a>
                                                                    </div>
                                                                    <style>
                                                                        .max-lines {
                                                                            display: block;
                                                                            text-overflow: ellipsis;
                                                                            white-space: nowrap;
                                                                            word-wrap: break-word;
                                                                            overflow: hidden;
                                                                        }
                                                                    </style>
                                                                </div>

                                                                {% endfor %}
                                                            </div>
                                                            <div class="files-wr w-100" id="selected_image0"
                                                                data-count-files="0" style="display: none ;">
                                                                <div class="one-file"><label for="file-3">Attach
                                                                        file</label><input type="file" name="attachment"
                                                                        id="file-3">
                                                                    <a class="file-item hide-btn"><span
                                                                            class="file-name"></span><span
                                                                            class="btn btn-del-file"><i
                                                                                class="fa fa-times"
                                                                                aria-hidden="true"></i></span>
                                                                    </a>
                                                                </div>
                                                                <div class="one-file"><label for="file-2">Attach
                                                                        file</label><input type="file" name="attachment"
                                                                        id="file-2">
                                                                    <a class="file-item hide-btn"><span
                                                                            class="file-name"></span><span
                                                                            class="btn btn-del-file"><i
                                                                                class="fa fa-times"
                                                                                aria-hidden="true"></i></span>
                                                                    </a>
                                                                </div>
                                                                <div class="one-file">
                                                                    <label for="file-1">Attach file</label>
                                                                    <input name="attachment" id="file-1" type="file">
                                                                    <a class="file-item hide-btn">
                                                                        <span class="file-name"></span>
                                                                        <span class="btn btn-del-file"><i
                                                                                class="fa fa-times"
                                                                                aria-hidden="true"></i></span>
                                                                    </a>
                                                                </div>
                                                            </div>

                                                            <!-- <a style="color: black;
                                                                    font-weight: bold;" target="_blank" href="./media/{{i.attached_file}}"><i class="fa fa-eye" aria-hidden="true"></i></a>
                                                                    <a style="color: black;
                                                                    font-weight: bold;" href="delete_image_action?id={{i.id}}"><i class="fa fa-trash" aria-hidden="true"></i></a> -->
                                                        </div>

                                                    </div>

                                                    {% endif %}

                                                </div>
                                            </div>

                                        </div>
                                        {% if history %}
                                        <div class="paytab w-100">
                                            <ul class="nav nav-tabs nav-pay" role="tablist">
                                                <h5 style="margin: 7px 0;">Log</h5>
                                            </ul>

                                            <div class="tab-content text-muted">

                                                <div class="tab-pane active show" role="tabpanel">
                                                    <div class="row actvty">
                                                        <!-- <h5></h5> -->
                                                    </div>

                                           
                                                    {% for j in history %}

                                                    <div class="row">
                                                        <i class="fas fa-level-up-alt log-level"></i>
                                                        <div class="col msging schdul-box mt-1 d-flex">
                                                            {% if j.user_type == "administrator" %}
                                                            <img src="{% static 'adminicon.jpg' %}" alt="">
                                                            {% else %}
                                                            {% if j.assigned_user_id.atatchment == '' %}
                                                            <img src="{% static 'adminicon.jpg' %}" alt="">

                                                            {% else %}
                                                            {% if j.assigned_user_id.atatchment == None %}
                                                            {% if j.log_type == 'booking_submit' %}
                                                            {% if j.action_appy_user.atatchment == '' %}
                                                            <img src="{% static 'adminicon.jpg' %}" alt="">

                                                            {% elif j.action_appy_user.atatchment == None %}
                                                            <img src="{% static 'adminicon.jpg' %}" alt="">

                                                            {% else %}

                                                            <img src="../media/{{j.action_appy_user.atatchment}}"
                                                                alt="">
                                                            {% endif %}

                                                            {% else %}

                                                            {% endif %}

                                                            {% else %}
                                                            <img src="../media/{{j.assigned_user_id.atatchment}}"
                                                                alt="">
                                                            {% endif %}
                                                            {% endif %}
                                                            {% endif %}
                                                            <div class="col-9 pl-0">
                                                                {% if j.user_type == "administrator" %}
                                                                <h5>{{j.user_type|title}} <span> {{j.dt}} {{j.tm}}</span></h5>
                                                                {% else %}
                                                                <h5><a href="user_edit?id={{j.action_appy_user.id}}">{{j.auth_user.email}}</a>  <span>{{j.dt}} {{j.tm}}</span></h5>
                                                                {% endif %}
                                                                <h6>{{j.d_text}}</span>
                                                                </h6>
                                                                <h6><span>{{j.status_content}}</span></h6>
                                                            </div>


                                                        </div>
                                                    </div>

                                                    {% endfor %}
                                                







                                                </div>
                                            </div>
                                        </div>
                                        {% endif %}
                                    </div>


                                </div>



                            </div>




                        </div>
                    </div>



                </div>

            </div>



        </div>
    </div>


</form>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="{% static 'admin/js/jquery.min.js' %}"></script>

{% if messages %}
<script>
    {% for message in messages %}
    message1 = "{{message}}"
    if (message1 == "error") {
        Swal.fire({
            icon: 'error',
            title: 'Oops...',
            text: "{{ message }}",
        })

    } else {
        Swal.fire(
            '',
            '{{ message }}',
            '{{message.tags}}'
        )
    } {% endfor %}
</script>
{% endif %}

<!-- <script>
     function customer_length(){

    var customer_id = document.getElementById('customer_id');
    if(customer_id.value.length!=10){
        alert("customer id must contain 10 digits")
    }
}
</script> -->


{% endblock %}